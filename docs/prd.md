# äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)ï¼šPolymarket å·¨é²¸ç›‘æ§ Telegram æœºå™¨äºº

**é¡¹ç›®åç§°**ï¼šPolymarket Smart Money Monitor Bot  
**ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2025-12-04  
**çŠ¶æ€**ï¼šå¼€å‘ä¸­

---

## 1. é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡

ç”¨æˆ·å¸Œæœ›é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·ç›‘æ§ç‰¹å®šçš„ Polymarket è´¦æˆ·ï¼ˆå¦‚å·¨é²¸ã€Smart Moneyï¼‰ï¼Œä»¥ä¾¿åœ¨å…¶è¿›è¡Œé¢„æµ‹äº¤æ˜“æ—¶ç¬¬ä¸€æ—¶é—´è·å–é€šçŸ¥ã€‚é¡¹ç›®æ—¨åœ¨æ„å»ºä¸€ä¸ª Telegram æœºå™¨äººï¼Œç»“åˆé“¾ä¸Šå®æ—¶äº‹ä»¶ç›‘å¬ä¸ Polymarket ä¸šåŠ¡æ•°æ®æ¥å£ï¼Œæä¾›å¿«é€Ÿã€å¯è¯»çš„è·Ÿå•ä¿¡å·ã€‚

## 2. æ ¸å¿ƒåŠŸèƒ½æ¦‚è¿°

1.  **åœ°å€ç®¡ç†**ï¼šé€šè¿‡ Telegram æŒ‡ä»¤ç®¡ç†ç›‘æ§åˆ—è¡¨ï¼ˆæ·»åŠ /åˆ é™¤/æŸ¥çœ‹ï¼‰ã€‚
2.  **é“¾ä¸Šç›‘å¬**ï¼šä½¿ç”¨ WebSocket å®æ—¶ç›‘å¬ Polygon é“¾ä¸Š Polymarket CTF åˆçº¦çš„ ERC1155 è½¬è´¦äº‹ä»¶ã€‚
3.  **æ•°æ®è§£æ**ï¼šè§¦å‘äº¤æ˜“åï¼Œè°ƒç”¨ API è·å–å…·ä½“çš„é¢„æµ‹äº‹ä»¶ã€è´­ä¹°æ–¹å‘å’Œé‡‘é¢ã€‚
4.  **å®æ—¶æ¨é€**ï¼šå°†è§£æåçš„æ•°æ®æ ¼å¼åŒ–å‘é€è‡³ Telegramã€‚

---

## 3. è¯¦ç»†ä¸šåŠ¡æµç¨‹ (User Flow)

1.  **é…ç½®é˜¶æ®µ**ï¼š

    - ç”¨æˆ·å‘æœºå™¨äººå‘é€ `/add 0x... [å¤‡æ³¨]` æŒ‡ä»¤ã€‚
    - ç³»ç»Ÿå°†åœ°å€åŠ å…¥å†…å­˜/æ•°æ®åº“çš„ Watchlistã€‚

2.  **ç›‘å¬é˜¶æ®µ**ï¼š

    - ç³»ç»Ÿé€šè¿‡ `ethers.js` WebSocket è¿æ¥ Polygon èŠ‚ç‚¹ã€‚
    - å®æ—¶è¿‡æ»¤åˆçº¦ `0x4d97dcd97ec945f40cf65f87097ace5ea0476045` çš„æ—¥å¿—ã€‚
    - **è§¦å‘æ¡ä»¶**ï¼š
      - äº‹ä»¶ç±»å‹ä¸º `TransferSingle` æˆ– `TransferBatch`ã€‚
      - `to`ï¼ˆæ¥æ”¶æ–¹ï¼‰åœ°å€åœ¨ Watchlist ä¸­ã€‚
      - `value` (æˆ– batch ä¸­çš„ä»»æ„ value) > 0ã€‚

3.  **å¤„ç†é˜¶æ®µ**ï¼ˆå…³é”®é€»è¾‘ï¼‰ï¼š

    - æ•è·åˆ°é“¾ä¸Šäº‹ä»¶åï¼Œç³»ç»Ÿ**å»¶è¿Ÿ 1~3 ç§’**ï¼ˆç­‰å¾…ä¸­å¿ƒåŒ– API ç´¢å¼•æ›´æ–°ï¼‰ã€‚
    - è°ƒç”¨ Polymarket Activity API æŸ¥è¯¢è¯¥ç”¨æˆ·æœ€æ–°çš„æ´»åŠ¨è®°å½•ã€‚
    - ç­›é€‰é€»è¾‘ï¼šæ‰¾åˆ°æœ€æ–°çš„ `type="TRADE"` ä¸” `side="BUY"` çš„è®°å½•ã€‚

4.  **æ¨é€é˜¶æ®µ**ï¼š
    - ç»„è£…åŒ…å«äº‹ä»¶æ ‡é¢˜ã€é¢„æµ‹ç»“æœã€é‡‘é¢ã€ä»·æ ¼çš„å¯Œæ–‡æœ¬æ¶ˆæ¯ã€‚
    - å‘é€è‡³ Telegramã€‚

---

## 4. åŠŸèƒ½éœ€æ±‚è¯´æ˜

### 4.1 Telegram äº¤äº’æŒ‡ä»¤

| æŒ‡ä»¤      | å‚æ•°               | æè¿°                                |
| :-------- | :----------------- | :---------------------------------- |
| `/add`    | `<address> [name]` | æ·»åŠ ç›‘æ§åœ°å€ã€‚éœ€æ ¡éªŒ ETH åœ°å€æ ¼å¼ã€‚ |
| `/remove` | `<address>`        | ç§»é™¤ç›‘æ§åœ°å€ã€‚                      |
| `/list`   | æ—                  | åˆ—å‡ºå½“å‰ç›‘æ§çš„æ‰€æœ‰åœ°å€åŠå¤‡æ³¨ã€‚      |
| `/start`  | æ—                  | æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯å’Œæ“ä½œæŒ‡å—ã€‚            |

### 4.2 åç«¯æŠ€æœ¯è§„æ ¼

#### A. é“¾ä¸Šç›‘å¬é…ç½®

- **ç½‘ç»œ**ï¼šPolygon Mainnet
- **RPC**ï¼šWSS åè®® (éœ€æ”¯æŒæ–­çº¿é‡è¿ `Keep-Alive`)
- **åˆçº¦åœ°å€**ï¼š`0x4d97dcd97ec945f40cf65f87097ace5ea0476045` (CTF Exchange)
- **ABI**ï¼š
  ```javascript
  [
    "event TransferSingle(address indexed operator, address indexed from, address indexed to, uint256 id, uint256 value)",
    "event TransferBatch(address indexed operator, address indexed from, address indexed to, uint256[] ids, uint256[] values)",
  ];
  ```

#### B. API æ•°æ®è·å–

- **æ¥å£åœ°å€**ï¼š`https://data-api.polymarket.com/activity`
- **è¯·æ±‚æ–¹å¼**ï¼šGET
- **å‚æ•°**ï¼š
  - `user`: `<ç›‘æ§åˆ°çš„é’±åŒ…åœ°å€>`
  - `limit`: `25`
  - `offset`: `0`
- **è§£æé€»è¾‘**ï¼š
  - éå†è¿”å›æ•°ç»„ï¼Œæå–ç¬¬ä¸€æ¡æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æ•°æ®ï¼š
    1.  `type` == "TRADE"
    2.  `side` == "BUY"
    3.  `timestamp` æ¥è¿‘å½“å‰æ—¶é—´ (å®¹å·® Â±1 åˆ†é’Ÿ)

### 4.3 æ¶ˆæ¯æ¨¡æ¿ (Telegram Message)

æ¶ˆæ¯éœ€æ”¯æŒ HTML æˆ– Markdown è§£ææ¨¡å¼ã€‚

**æ¨¡ç‰ˆç¤ºä¾‹ï¼š**

```text
ğŸš¨ **Polymarket ç›‘æ§æé†’**

ğŸ‘¤ **ç”¨æˆ·**ï¼š[å¤‡æ³¨å] (0xAB...1234)
ğŸ›’ **æ“ä½œ**ï¼šä¹°å…¥ (BUY)

ğŸ“… **é¢„æµ‹äº‹ä»¶**ï¼šWill Bitcoin hit $100k in 2024?
ğŸ¯ **ä¸‹æ³¨ç»“æœ**ï¼šYes
ğŸ’° **æŠ•å…¥é‡‘é¢**ï¼š$5,000.00
ğŸ“Š **æˆäº¤å‡ä»·**ï¼š$0.65

â° **æ—¶é—´**ï¼š2024-12-04 12:00:00
ğŸ”— [æŸ¥çœ‹äº‹ä»¶](https://polymarket.com/event/{slug}) | [ç”¨æˆ·ä¸»é¡µ](https://polymarket.com/profile/{address})

5. å¼‚å¸¸å¤„ç†ä¸æ€§èƒ½è¦æ±‚
WebSocket ç¨³å®šæ€§ï¼š

å¿…é¡»å¤„ç† connection closed å’Œ error äº‹ä»¶ã€‚

å®ç°è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼ˆExponential Backoffï¼‰ï¼Œé˜²æ­¢ç›‘æ§ä¸­æ–­ã€‚

API æ•°æ®å»¶è¿Ÿå¤„ç†ï¼š

è‹¥é“¾ä¸Šç›‘å¬åˆ°äº‹ä»¶ï¼Œä½† API å°šæœªæ›´æ–°ï¼ˆæ‰¾ä¸åˆ°å¯¹åº”çš„æœ€æ–° Tradeï¼‰ï¼Œç³»ç»Ÿåº”æ‰§è¡Œé‡è¯•æœºåˆ¶ï¼šæ¯éš” 1.5 ç§’é‡è¯•ä¸€æ¬¡ï¼Œæœ€å¤šé‡è¯• 3 æ¬¡ã€‚

å»é‡ï¼š

TransferBatch å¯èƒ½ä¼šåŒ…å«å¤šä¸ª Token IDï¼Œä½†å¯¹åº” API é‡Œé€šå¸¸æ˜¯ä¸€ç¬” Tradeã€‚éœ€é€šè¿‡ transactionHash æˆ–æ—¶é—´æˆ³çª—å£é˜²æ­¢é‡å¤æ¨é€åŒä¸€ç¬”äº¤æ˜“ã€‚

6. æŠ€æœ¯æ ˆå»ºè®®
Runtime: Node.js (TypeScript æ¨è)

Blockchain Lib: ethers v6

HTTP Client: axios

Bot Framework: node-telegram-bot-api or grammy

Database: SQLite/JSON file (MVPé˜¶æ®µ) -> Redis/PostgreSQL (ç”Ÿäº§ç¯å¢ƒ)
```
